/*!
 * slider.js v1.4 | MIT License | (c) 2025 Maksim Postnikov
 * https://postnikovmd.com/mods/slider
 */

!function(e){let t=function(e,d){d=d||{},d={rows:1,arrows:!1,select:!1,loop:!1,center:!1,transition:300,easing:"ease-in-out",drag:!0,slides:".slide",elems:".slide-elem",blocks:e+"-block",prev:"#prev",next:"#next",padding:!0,vertical:!1,hash:!1,autoplay:!1,interval:6e3,container:".container",arrange:!0,filter:!0,nesting:1,slider:{active:0,slide:{},spacing:{},wrap:{},listeners:{}},...d},void 0===window.slider&&(window.slider={}),void 0===window.drag&&(window.drag={}),void 0===window.drag.loaded&&(window.drag.loaded=!1);let c=function(){let c=document.querySelectorAll(e+", "+e+"-block");if(c.length>0){if(void 0===d.slider.wrap.state&&0===Array.from(document.querySelectorAll("."+e.substring(1).replace("rec","slider")+"-container")).length){let t=document.createElement("div");t.className=e.substring(1).replace("rec","slider")+"-container",c.forEach((e=>{e.parentNode.insertBefore(t,e),t.appendChild(e)}))}d.slides.selector&&(d.slides=d.slides.selector),d.elems.selector&&(d.elems=d.elems.selector);let h,p=Array.from(document.querySelectorAll(e));if(p=p.find((function(e){return null!==e.querySelector(d.slides)})),p){p.classList.add("tn-slider");let c,w=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container");w.classList.add("t-slider-container");let m="window"===t396_ab__getFieldValue(p.querySelector(".t396__artboard"),"upscale"),v=p.querySelector(d.container);v?(v.classList.add("tn-wrapper"),c=v,void 0===d.slider.wrap.state&&v.querySelector(".tn-atom").remove(),d.slider.wrap.state=!0):c=p.querySelector(".t396__artboard");let g=Array.from(w.querySelectorAll(d.slides));if(g.length>0){let e=1;d.slider.wrap.state&&(e=2),d.filter&&(g=t_filterElems(g,{nesting:e,exclude:!0})),d.arrange&&(g=t_arrangeElems(g)),g.forEach((function(e){e.classList.add("tn-slide")})),d.slides={selector:d.slides,amount:g.length}}if(g.length>0){let y=Array.from(w.querySelectorAll(d.elems));y.length>0&&(d.arrange&&(y=t_arrangeElems(y,w.querySelectorAll(d.slides.selector))),y.forEach((function(e){e.classList.add("tn-slide-elem")})),d.elems={selector:d.elems,amount:Math.ceil(y.length/g.length)});let b=Array.from(w.querySelectorAll(d.blocks));b.length>0&&b.forEach((function(e){e.classList.add("tn-slider-block")}));let _=Array.from(w.querySelectorAll('a[href="'+d.prev+'"]')).map((e=>e.classList.contains("tn-atom")||e.classList.contains("tn-molecule")?e.parentElement:e));_.length>0?(_.forEach((e=>e&&e.classList.add("tn-controls","prev"))),d.arrows||(d.arrows=!0)):(_=Array.from(w.querySelectorAll(".prev")),!_.length>0&&(_=Array.from(w.querySelectorAll(`a[href="${d.prev}"]`))),_.length>0?(_.forEach((e=>e.classList.add("tn-controls"))),d.arrows||(d.arrows=!0)):d.arrows&&t_sendError("slider-no-prev","Не найдена кнопка "+d.prev+" ("+e+")"));let L=Array.from(w.querySelectorAll('a[href="'+d.next+'"]')).map((e=>e.classList.contains("tn-atom")||e.classList.contains("tn-molecule")?e.parentElement:e));if(L.length>0?(L.forEach((e=>e&&e.classList.add("tn-controls","next"))),d.arrows||(d.arrows=!0)):(L=Array.from(w.querySelectorAll(".next")),!L.length>0&&(L=Array.from(w.querySelectorAll(`a[href="${d.next}"]`))),L.length>0?(L.forEach((e=>e.classList.add("tn-controls"))),d.arrows||(d.arrows=!0)):d.arrows&&t_sendError("slider-no-next","Не найдена кнопка "+d.next+" ("+e+")")),c){if(c.classList.add("tn-slider-artboard"),d=r(e,d),i(e,d),d.slider.wrap.state){let t=g[0].parentElement?.closest(".tn-group");for(let e=1;e<d.nesting;e++)t=t.parentElement;let i=Array.from(v.children);t?(t.classList.add("tn-slider-group"),v.append(t),t.style.left="",t.style.zoom="",i.forEach((e=>{e.style.zoom=""}))):t_sendError("slider-no-group","Для встраивания в шейп элементы слайдера должны быть сгруппированы ("+e+")")}let y=document.createElement("div");y.className="tn-slider-spacing",y.style.position="absolute",y.style.height=d.slider.slide.height+"px",y.style.top="0px",y.style.left=d.slider.spacing.offsetLeft+d.slider.slide.shiftLeft+"px",y.innerHTML='<div class="tn-atom" style="height: 100%"></div>',c.insertBefore(y,c.firstChild);let b=1;d.slider.wrap.state?b=1:m&&(b=void 0!==window.tn["ab"+p.id.replace("rec","")].scaleFactor?window.tn["ab"+p.id.replace("rec","")].scaleFactor:window.tn_scale_factor);let E=w.querySelector(".tn-slider-spacing");if(m&&(E.style.zoom=b),E.children[0].style.width=d.slider.spacing.width+"px",E.children[0].style.height=Math.min(...d.slider.heights)+"px",E.children[0].style.display="block",c.addEventListener("scroll",function(e,t){let i;return function(...r){clearTimeout(i),i=setTimeout((function(){clearTimeout(i),e(...r)}),t)}}((function(){d.select||(d.slider.active=l(e,d)),d.arrows&&o(e,d)}),100)),d.arrows&&(L.forEach((t=>{if(null===t.getAttribute("href")){let e=t.querySelector("a");e&&e.removeAttribute("href")}else t.removeAttribute("href");t.classList.contains("slider-listener")||(t.classList.add("slider-listener"),t.addEventListener("click",(function(){s(e,d,"next")})))})),_.forEach((t=>{if(null===t.getAttribute("href")){let e=t.querySelector("a");e&&e.removeAttribute("href")}else t.removeAttribute("href");t.classList.contains("slider-listener")||(t.classList.add("slider-listener"),t.addEventListener("click",(function(){s(e,d,"prev")})))}))),d.autoplay&&d.autoplay!==d.interval){let t=setInterval((function(){s(e,d,"next")}),d.interval);L.forEach((e=>{e.addEventListener("click",(function(){clearInterval(t)}))})),_.forEach((e=>{e.addEventListener("click",(function(){clearInterval(t)}))})),c.addEventListener("mousedown",(function(){clearInterval(t)})),c.addEventListener("touchmove",(function(){clearInterval(t)})),d.autoplay=d.interval,delete d.interval}if(d.select)if(g.forEach(((t,i)=>{t.addEventListener("click",(function(){s(e,d,i)}))})),d.hash){let t=f();null!==t&&t!==d.slider.active?s(e,d,t):a(e,d,d.slider.active)}else a(e,d,d.slider.active);else l(e,d);d.arrows&&o(e,d),d.drag&&n(e,d),void 0===d.slider.listeners.resize&&(window.addEventListener("resize",(function(){d.currentWidth!==window.innerWidth&&(clearTimeout(h),h=setTimeout((function(){u(e),setTimeout((function(){t(e,d)}),300),d.currentWidth=window.innerWidth}),500))})),d.slider.listeners.resize=!0),d.active&&s(e,d,d.active),d.id=e.substring(1).replace("uc-","").replace("rec",""),window.slider[d.id]=d,t_dispatchEvent("slider","init",d.id)}else t_sendError("slider-not-zero","Слайдер не является Zero-блоком ("+e+")")}else t_sendError("slider-no-slides","Слайды "+d.slides.selector+" не найдены ("+e+")")}else t_sendError("slider-no-artboard","Не найдено ни одного блока, содержащего слайды "+(void 0!==d.slides.selector?d.slides.selector:d.slides)+" ("+e+")")}else t_sendError("slider-no-slider","Слайдер не найден ("+e+")")};void 0===d.event?t_onReady((function(){setTimeout((function(){c()}),300)})):void 0===d.timeout||isNaN(d.timeout)?t_catchEvent(d.event,(function(){c()})):t_catchEvent(d.event,(function(){setTimeout((function(){c()}),Math.max(d.timeout,0))}))},i=function(e,t){let i=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),r="."+e.substring(1)+"-container { --slider-scale: "+t.scale.factor+"; --slider-transition: "+t.transition+"ms; --slider-easing: "+t.easing+"; --slider-artboard-height: "+t.scale.height+"px; --slider-shift: "+t.slider.slide.shiftLeft+"px; --slides-width: "+t.slider.widths[0]+"px; --slides-height: "+t.slider.heights[0]+"px; --slides-gap: "+t.slider.gaps[0]+"px; ";if("window"===t.bind){let e;i.setAttribute("data-bind","window");try{window.tn["ab"+id]&&void 0!==window.tn["ab"+id].canvas_min_width&&(e=window.tn["ab"+id].canvas_min_width)}catch(t){void 0!==window.rescale&&(void 0!==window.rescale.min?e=window.rescale.min:void 0!==window.rescale.premin&&(e=window.rescale.premin))}r+="--slider-min-width: "+e+"; "}t.select&&i.setAttribute("data-select",""),t.slider.wrap.state&&(r+="--slider-wrap-height: "+t.slider.wrap.height+"px; --slider-wrap-width: "+t.slider.wrap.width+"px; --slider-wrap-offset-left: "+t.slider.wrap.offsetLeft+"px; --slider-wrap-offset-top: "+t.slider.wrap.offsetTop+"px; "),void 0!==t.style&&(void 0!==t.style.active&&(void 0!==t.style.active.backgroundColor&&(i.setAttribute("data-active-bgcolor",t.style.active.backgroundColor),r+="--active-bgcolor: "+t.style.active.backgroundColor+"; "),void 0!==t.style.active.borderColor&&(i.setAttribute("data-active-bordercolor",t.style.active.borderColor),r+="--active-bordercolor: "+t.style.active.borderColor+"; "),void 0!==t.style.active.opacity&&(i.setAttribute("data-active-opacity",t.style.active.opacity),r+="--active-opacity: "+t.style.active.opacity+"; "),void 0!==t.style.active.scale&&(i.setAttribute("data-active-scale",t.style.active.scale),r+="--active-scale: "+t.style.active.scale+"; ")),void 0!==t.style.visible&&(i.setAttribute("data-advanced",""),void 0!==t.style.visible.blur&&(i.setAttribute("data-visible-blur",t.style.visible.blur),r+="--visible-blur: "+t.style.visible.blur+"px; "),void 0!==t.style.visible.grayscale&&(i.setAttribute("data-visible-grayscale",t.style.visible.grayscale),r+="--visible-grayscale: "+t.style.visible.grayscale+"; "),void 0!==t.style.visible.opacity&&(i.setAttribute("data-visible-opacity",t.style.visible.opacity),r+="--visible-opacity: "+t.style.visible.opacity+"; ")),void 0!==t.style.inactive&&(i.setAttribute("data-advanced",""),void 0!==t.style.inactive.blur&&(i.setAttribute("data-inactive-blur",t.style.inactive.blur),r+="--inactive-blur: "+t.style.inactive.blur+"px; "),void 0!==t.style.inactive.grayscale&&(i.setAttribute("data-inactive-grayscale",t.style.inactive.grayscale),r+="--inactive-grayscale: "+t.style.inactive.grayscale+"; "),void 0!==t.style.inactive.opacity&&(i.setAttribute("data-inactive-opacity",t.style.inactive.opacity),r+="--inactive-opacity: "+t.style.inactive.opacity+"; "),void 0!==t.style.inactive.scale&&(i.setAttribute("data-inactive-scale",t.style.inactive.scale),r+="--inactive-scale: "+t.style.inactive.scale+"; ")),void 0!==t.style.controls&&(void 0!==t.style.controls.backgroundColor&&(i.setAttribute("data-controls-bgcolor",t.style.controls.backgroundColor),r+="--controls-bgcolor: "+t.style.controls.backgroundColor+"; "),void 0!==t.style.controls.backgroundImage&&(i.setAttribute("data-controls-bgimage",t.style.controls.backgroundImage),r+="--controls-bgimage: url("+t.style.controls.backgroundImage+"); "),void 0!==t.style.controls.borderColor&&(i.setAttribute("data-controls-bordercolor",t.style.controls.borderColor),r+="--controls-bordercolor: "+t.style.controls.borderColor+"; ")));let s=document.createElement("style");if(s.classList.add("tn-slider-styles"),s.textContent=r+"}",i.appendChild(s),!window.slider.loaded){let e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.jsdelivr.net/gh/maybeede/mods/tilda@1.4/slider.min.css",document.head.appendChild(e),window.slider.loaded=!0}},r=function(e,t){let i=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),r=Array.from(i.querySelectorAll(".tn-slide"));r.length&&t.arrange&&(r=t_arrangeElems(r));let s=i.querySelector(".tn-slider-artboard"),l=s.getAttribute("data-artboard-recid"),a="window"===t396_ab__getFieldValue(s,"upscale"),o=i.querySelector(t.container),n=i.querySelector(".tn-group:has( > .tn-molecule > .tn-slide)");n&&n.classList.contains("t396__group-flex")&&i.setAttribute("data-flex",""),r.every((function(e){return"window"===t396_elem__getFieldValue(e,"container")}))?t.bind="window":t.bind="grid";let d=Array.from(i.querySelectorAll(".prev")),c=Array.from(i.querySelectorAll(".next"));t.scale=t_getCurrentScale(e),t.slider.wrap.state?(scale=1,t.scale.height=t396_elem__getHeight(s)):(scale=t.scale.factor,t.scale.height=Math.ceil(t396_ab__getHeight(s)*t.scale.factor)),t.slider.offsetLeft=Math.round((window.innerWidth-t.scale.breakpoint*t.scale.factor)/2),t.slider.wrap.state&&(t.slider.offsetLeft=0),t.slider.slide.offsetLeft=0;let f=0;a&&!window.rescale["ab"+l]||window.tn&&window.tn["ab"+l]&&window.tn["ab"+l].grid_offset_left&&(f=window.tn["ab"+l].grid_offset_left);let u=parseInt(t396_elem__getFieldValue(r[0],"left"));t.slider.slide.offsetLeft=u+f-t.slider.offsetLeft,t.slider.wrap.state&&(t.slider.slide.offsetLeft=0),t.slider.widths=[];for(let e=0;e<r.length;e++){let i=parseInt(t396_elem__getFieldValue(r[e],"width"));t.slider.widths.push(parseInt(i))}t_checkUniformity(t.slider.widths)||t_sendError("slider-diff-size","Размеры слайдов отличаются ("+e+"). Для корректной работы рекомендуется задать им одинаковую ширину","warn"),t.slider.heights=[];for(let e=0;e<r.length;e++){let i=parseInt(t396_elem__getFieldValue(r[e],"height"));t.slider.heights.push(parseInt(i))}t.slider.gaps=[];for(let e=0;e<r.length-1;e++){let i=parseInt(t396_elem__getFieldValue(r[e],"left"))-t.slider.offsetLeft,s=parseInt(t396_elem__getFieldValue(r[e+1],"left"))-t.slider.offsetLeft-i-r[e].offsetWidth;t.slider.gaps.push(s)}if(t.vertical){t.slider.gaps=[];for(let e=0;e<r.length-1;e++){let i=parseInt(t396_elem__getFieldValue(r[e],"top")),s=parseInt(t396_elem__getFieldValue(r[e+1],"top"))-i-r[e].offsetHeight;t.slider.gaps.push(s)}}if(t_checkUniformity(t.slider.gaps)||t_sendError("slider-diff-gaps","Расстояние между слайдами отличается ("+e+"). Для корректной работы рекомендуется располагать их на одинаковом расстоянии друг от друга","warn"),t.slider.slide.width=t.slider.widths[0]+t.slider.gaps[0],t.slider.slide.spacing=t.slider.gaps[0],t.slider.slide.shiftLeft=0,t.slider.spacing.offsetLeft=t.slider.offsetLeft+t.slider.slide.offsetLeft,t.currentWidth=window.innerWidth,t.slider.wrap.state){switch(t.padding){case!0:t.slider.wrap.offsetLeft=Math.max(parseInt(t396_elem__getFieldValue(r[0],"left"))-parseInt(t396_elem__getFieldValue(o,"left")),0),t.slider.wrap.offsetTop=Math.max(parseInt(t396_elem__getFieldValue(r[0],"top"))-parseInt(t396_elem__getFieldValue(o,"top")),0),t.center&&(t.vertical?t.slider.wrap.offsetTop=0:t.slider.wrap.offsetLeft=0);break;case!1:t.slider.wrap.offsetLeft=0,t.slider.wrap.offsetTop=0;break;default:t.vertical?(t.slider.wrap.offsetTop=t.padding,t.slider.wrap.offsetLeft=Math.max(parseInt(t396_elem__getFieldValue(r[0],"left"))-parseInt(t396_elem__getFieldValue(o,"left")),0)):(t.slider.wrap.offsetLeft=t.padding,t.slider.wrap.offsetTop=Math.max(parseInt(t396_elem__getFieldValue(r[0],"top"))-parseInt(t396_elem__getFieldValue(o,"top")),0))}t.vertical&&(t.slider.slide.height=t.slider.heights[0]+t.slider.gaps[0])}else t.vertical&&(t.vertical=!1);return t.rows>1?(t.slider.rowsShift=Math.round(r[1].offsetLeft-r[0].offsetLeft),r.length%t.rows%2==0?t.slider.width=t.slider.slide.width*Math.floor(r.length/t.rows)-t.slider.slide.spacing+t.slider.rowsShift:t.slider.width=t.slider.slide.width*Math.floor(r.length/t.rows)-t.slider.slide.spacing+t.slider.slide.width):(t.slider.rowsShift=0,t.slider.width=t.slider.slide.width*Math.floor(r.length/t.rows)-t.slider.slide.spacing),t.slider.wrap.state?t.vertical?(t.slider.height=t.slider.slide.height*r.length-t.slider.slide.spacing,t.slider.wrap.height=o.offsetHeight,t.slider.onscreen=Math.floor((t.slider.wrap.height+t.slider.slide.spacing)/t.slider.height*r.length/t.rows)):(t.slider.wrap.width=parseInt(t396_elem__getFieldValue(o,"width")),t.slider.wrap.height=parseInt(t396_elem__getHeight(o)),t.slider.wrap.offset={left:parseInt(t396_elem__getFieldValue(o,"left")),top:parseInt(t396_elem__getFieldValue(o,"top"))},t.slider.onscreen=Math.floor((t.slider.wrap.width+t.slider.slide.spacing)/t.slider.width*r.length/t.rows)):t.slider.onscreen=Math.floor(t.scale.breakpoint/(t.slider.width+2*t.slider.slide.offsetLeft)*r.length/t.rows),isFinite(t.slider.onscreen)||(t.slider.onscreen=0),t.slider.onscreen>r.length&&(t.slider.onscreen=r.length),t.center?(t.rows<=1&&t.slider.onscreen<=2&&(t.slider.onscreen=1),t.slider.onscreen>t.rows&&t.slider.onscreen%2==0?t.slider.midIndex=[Math.floor((t.slider.onscreen+1)/2)-1,Math.ceil((t.slider.onscreen+1)/2)-1]:t.slider.onscreen>t.rows&&t.slider.onscreen%2!=0?t.slider.midIndex=[Math.round((t.slider.onscreen+1)/2)-1]:t.slider.midIndex=[0],t.slider.slide.activeShift=Math.min(...t.slider.midIndex)):(t.slider.midIndex=[0],t.slider.slide.activeShift=0),r.length>t.slider.onscreen?("window"===t.bind?t.slider.spacing.width=t.slider.width+t.slider.spacing.offsetLeft:t.slider.spacing.width=t.slider.width+t.slider.offsetLeft+t.slider.slide.offsetLeft,t.arrows&&d.forEach((e=>e&&e.classList.replace("active","inactive"))),t.center&&(t.slider.wrap.state?t.slider.slide.shiftLeft=Math.ceil((t.slider.wrap.width-(t.slider.slide.width*t.slider.midIndex.length-t.slider.slide.spacing)+t.slider.rowsShift)/2-t.slider.slide.offsetLeft-t.slider.rowsShift):t.slider.slide.shiftLeft=Math.ceil((t.scale.breakpoint-(t.slider.slide.width*t.slider.midIndex.length-t.slider.slide.spacing)+t.slider.rowsShift)/2-t.slider.slide.offsetLeft-t.slider.rowsShift),setTimeout((function(){Array.from(s.children).forEach((function(e){e.classList.contains("tn-slider-spacing")||(e.style.transform="translateX("+t.slider.slide.shiftLeft+"px)")})),s.setAttribute("data-slider-center",""),s.setAttribute("data-slider-onscreen",t.slider.onscreen)}))),t.slider.spacing.width+=t.slider.slide.shiftLeft):(t.slider.spacing.width=t.slider.width+t.slider.spacing.offsetLeft,t.arrows&&(d.forEach((e=>e&&e.classList.replace("active","inactive"))),c.forEach((e=>e&&e.classList.replace("active","inactive"))))),t.slider.wrap.state&&(t.vertical?t.slider.spacing.width+=2*t.slider.wrap.offsetTop:t.slider.spacing.width+=2*t.slider.wrap.offsetLeft),(isMobile||t.select)&&(t.drag=!1),!0===t.autoplay&&(t.loop=!0),!0===t.vertical&&(t.rows=1,t.center=!1,i.setAttribute("data-vertical","")),t},s=function(e,t,i){let r=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),s=Array.from(r.querySelectorAll(".tn-slide"));s.length&&t.arrange&&(s=t_arrangeElems(s));let l,n,f=r.querySelector(".tn-slider-artboard"),u=r.querySelector(".tn-wrapper");if(u&&(f=u),l=t.slider.wrap.state?1:t.scale.factor,f){switch(i){case"prev":i=t.slider.active-1,n="prev";break;case"next":i=t.slider.active+1,n="next";break;default:void 0===i?i=t.slider.active:n="auto"}if(i!==t.slider.active){let r,u,h,p=Math.round(t.slider.slide.width*l);r=t.vertical?t.slider.height*l:t.slider.width*l,u=t.vertical?Math.round(f.scrollTop):Math.round(f.scrollLeft),h=t.vertical?t.slider.slide.height:p;let w=.1;if("prev"===n||"next"===n){let c;"next"===n?(c=h,t.update=i<s.length):(c=-h,t.update=i>=0),t.select?(t.loop||t.update)&&(t.slider.active=a(e,t,i),o(e,t),d(f,h*t.slider.active,t.transition)):t.loop?("next"===n?u+h*(1-w)>h*(Math.ceil(s.length/t.rows)-t.slider.onscreen)+t.slider.slide.shiftLeft*l*2?t.scrollTo=0:t.scrollTo=u+h:t.scrollTo=u-h*(1-w)<0?u-h*w<0?r:0:u-h,d(f,t.scrollTo,t.transition,t.vertical)):d(f,u+c,t.transition,t.vertical)}else"auto"===n&&(t.slider.active=a(e,t,i),o(e,t),d(f,Math.round(h*(i/t.rows)),t.transition,t.vertical));t.select&&t.hash&&c(e,t.slider.active)}}},l=function(e,t){let i=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),r=Array.from(i.querySelectorAll(".tn-slide"));r.length&&t.arrange&&(r=t_arrangeElems(r));let s=Array.from(i.querySelectorAll(".tn-slide-elem"));s.length&&t.arrange&&(s=t_arrangeElems(s,i.querySelectorAll(t.slides.selector)));let l,a=i.querySelector(".tn-slider-artboard"),o=i.querySelector(".tn-wrapper");o&&(a=o),l=t.slider.wrap.state?1:t.scale.factor;let n=t.thresold||.5;if(void 0===t.slides.visibilities&&(t.slides.visibilities={}),a){let e,i=Math.round(a.offsetWidth/l),o=Math.round(a.offsetHeight/l);e=t.vertical?Math.round(Math.floor(a.scrollTop)/l):Math.round(Math.floor(a.scrollLeft)/l);let d=[],c=[];r.forEach((e=>e.classList.remove("visible","active"))),s.forEach((e=>e.classList.remove("visible","active")));let f=r.map(((r,s)=>{let l,a;t.vertical?(l=parseInt(t396_elem__getFieldValue(r,"top")),t.slider.wrap.state&&(l-=t.slider.wrap.offset.top)):(l=parseInt(t396_elem__getFieldValue(r,"left"))+t.slider.offsetLeft+t.slider.slide.shiftLeft,t.slider.wrap.state&&(l-=t.slider.wrap.offset.left)),a=t.vertical?t.slider.heights[s]:t.slider.widths[s];let n,d=l,c=l+a,f=e+t.slider.slide.offsetLeft;n=t.vertical?e+o:e+i-t.slider.slide.offsetLeft,t.center&&!t.vertical&&(n-=t.slider.slide.shiftLeft);let u,h=Math.round(Math.max(d,f)),p=Math.round(Math.min(c,n)),w=Math.round(Math.max(0,p-h));return u=a>0?Number((w/a).toFixed(4)):0,t.slides.visibilities[s]={viewstart:h,viewend:p,viewsize:w,ratio:u},{index:s,ratio:u,start:d,end:c}}));if(t.center){let r;r=t.vertical?Math.round(e+o/2):Math.round(e+i/2);let s=f.filter((e=>e.start<=r&&e.end>=r));if(s.length>0){s.sort(((e,t)=>t.ratio-e.ratio));let e=t.slider.midIndex.length;d=s.slice(0,e).map((e=>e.index))}else{s=f.filter((e=>e.ratio>=n)).sort(((e,t)=>t.ratio-e.ratio));let e=t.slider.midIndex.length;d=s.slice(0,e).map((e=>e.index))}}else{let e=f.find((e=>e.ratio>=n));if(e)d.push(e.index);else{let e=f.reduce(((e,t)=>t.ratio>e.ratio?t:e),f[0]);e&&d.push(e.index)}}if(void 0!==d[0]){let e=d[0];if(t.center){let i=Math.floor((t.slider.onscreen-1)/2),s=e+Math.floor((t.slider.onscreen-1)/2);for(let t=e-i;t<=s;t++)t>=0&&t<r.length&&t!==e&&c.push(t)}else for(let i=e+1;i<e+t.slider.onscreen&&i<r.length;i++)c.push(i)}return c.forEach((function(e){if(r[e]){r[e].classList.add("visible");for(let i=0;i<t.rows;i++)for(let r=0;r<t.elems.amount;r++){let l=(e*t.rows+i)*t.elems.amount+r;s[l]&&s[l].classList.add("visible")}}})),d.forEach((function(e){if(r[e]){r[e].classList.add("active");for(let i=0;i<t.rows;i++)for(let r=0;r<t.elems.amount;r++){let l=(e*t.rows+i)*t.elems.amount+r;s[l]&&s[l].classList.add("active")}}})),void 0!==d[0]?d[0]:0}},a=function(e,t,i){let r=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),s=Array.from(r.querySelectorAll(".tn-slide"));s.length&&t.arrange&&(s=t_arrangeElems(s));let l=Array.from(r.querySelectorAll(".tn-slide-elem"));l.length&&t.arrange&&(l=t_arrangeElems(l,r.querySelectorAll(t.slides.selector)));let a=Array.from(r.querySelectorAll(".tn-slider-block")),o=t.slider.active;if(o=i>s.length-1?t.loop?0:s.length-1:i<0?t.loop?Math.floor((s.length-1)/t.rows):0:Math.floor(i/t.rows),s.length>0&&(s.forEach((e=>e.classList.remove("active"))),s[o].classList.add("active")),l.length>0){l.forEach((e=>e.classList.remove("active")));const e=t.elems.selector.split(",");if(e.length>1&&e.length===t.elems.amount)for(let i=0;i<t.elems.amount;i++){let t=e[i].trim();const s=r.querySelectorAll(t);s.length>o&&s[o].classList.add("active")}else for(let e=0;e<t.elems.amount;e++){const i=o*t.elems.amount+e;l.length>i&&l[i].classList.add("active")}}if(a.length>0){let i=a[o];i?(a.forEach(((e,i)=>{i!==o&&(e.classList.remove("active"),e.classList.add("inactive"),e.style.opacity="0",setTimeout((function(){e.style.visibility="hidden",e.style.display="none",t_animateElems(e,"reset")}),t.transition))})),setTimeout((function(){i.style.display="block",i.style.visibility="visible",i.style.opacity="0",requestAnimationFrame((function(){i.style.opacity="1",i.classList.remove("inactive"),i.classList.add("active"),t_animateElems(i,"start"),t_lazyload_update()}))}),t.transition)):t_sendError("slider","Не найден блок слайда "+(o+1)+" ("+e+")")}return o},o=function(e,t){let i=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),r=i.querySelector(".tn-slider-artboard"),s=i.querySelector(".tn-wrapper");s&&(r=s);let l=Array.from(i.querySelectorAll(".tn-slide"));l.length&&t.arrange&&(l=t_arrangeElems(l));let a,o=Array.from(i.querySelectorAll(".prev")),n=Array.from(i.querySelectorAll(".next"));a=t.slider.wrap.state?1:t.scale.factor;r&&setTimeout((()=>{if(t.loop)o.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")})),n.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")}));else{let e,i;e=t.vertical?r.scrollTop:r.scrollLeft,i=t.vertical?t.slider.slide.height:t.slider.slide.width;let s,a,d=r.offsetWidth;s=t.vertical?t.slider.height-r.clientHeight:Math.round((t.slider.spacing.width+t.slider.slide.offsetLeft+t.slider.offsetLeft)*t.scale.factor)-d,a=t.vertical?t.slider.height-r.clientHeight:t.slider.spacing.width-d,t.center&&(s+=t.slider.slide.shiftLeft,a+=t.slider.slide.shiftLeft),"grid"===t.bind?e+2>=s?n.forEach((e=>{e.classList.remove("active"),e.classList.add("inactive")})):n.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")})):"window"===t.bind&&(e+2>=a?n.forEach((e=>{e.classList.remove("active"),e.classList.add("inactive")})):n.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")}))),e<=2?o.forEach((e=>{e.classList.remove("active"),e.classList.add("inactive")})):o.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")})),t.select&&(t.slider.active>=l.length-1?(o.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")})),n.forEach((e=>{e.classList.remove("active"),e.classList.add("inactive")}))):t.slider.active<=0?(o.forEach((e=>{e.classList.remove("active"),e.classList.add("inactive")})),n.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")}))):(o.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")})),n.forEach((e=>{e.classList.remove("inactive"),e.classList.add("active")}))))}}),t.transition)},n=function(e,t){let i=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container"),r=i.querySelector(".tn-slider-artboard"),s=i.querySelector(".tn-wrapper");if(s&&(r=s),!window.drag.loaded){r&&!0===t.drag&&(!function(e,t){let i={mousedown:!1,emaX:0,emaY:0},r={x:0,y:0};function s(e){let t=e.dataset.options?JSON.parse(e.dataset.options):{},r=i.emaX*t.deceleration;r<.01&&r>-.01||(l(e,r,0),setTimeout((()=>s(e)),1e3/t.decelRate))}function l(e,t,r){if((i.emaX<0&&t>0||i.emaX>0&&t<0)&&(i.emaX=0),(i.emaY<0&&r>0||i.emaY>0&&r<0)&&(i.emaY=0),e.dataset.options){let r=JSON.parse(e.dataset.options),s=r.acceleration*t+(1-r.acceleration)*i.emaX,l=e.scrollWidth-e.clientWidth;e.scrollLeft<=0&&t<=0||e.scrollLeft>=l&&t>=0||(e.scrollLeft+=s),i.emaX=s}}e.dataset.options=JSON.stringify(t),t.allowHiliting||(e.onmousedown=e=>e.preventDefault()),e.addEventListener("mousedown",(t=>{i.mousedown=e})),e.addEventListener("mouseup",(r=>{t.allowThrowing&&s(e),i.mousedown=!1})),e.addEventListener("mouseout",(r=>{let l=r.relatedTarget||r.toElement;l&&"HTML"!==l.nodeName||(i.mousedown&&t.allowThrowing&&t.throwOnOut&&s(e),i.mousedown=!1)})),document.addEventListener("mousemove",(e=>{if(i.mousedown){let t=i.mousedown,s=t.dataset.options?JSON.parse(t.dataset.options):{};if(s.rightMouse&&2!==e.button||!s.rightMouse&&2===e.button)return;let a=e.pageX-r.x;s.reverse||(a=-a),l(t,a,0)}r.x=e.pageX,r.y=e.pageY}))}(r,{acceleration:.65,deceleration:.85,decelRate:64}),r.addEventListener("mousedown",(function(){setTimeout((function(){r.style.cursor="grab";r.querySelectorAll(".tn-elem").forEach((e=>{e.style.pointerEvents="none"}))}),100)})),r.addEventListener("mouseup",(function(){setTimeout((function(){r.style.cursor="";r.querySelectorAll(".tn-elem").forEach((e=>{e.style.pointerEvents=""}))}),100)})),t.drag="drag")}},d=function(e,t,i,r=!1){let s;s=r?e.scrollTop:e.scrollLeft;let l=t-s,a=performance.now();requestAnimationFrame((function t(o){let n,d=Math.min((o-a)/i,1);n=d<.5?2*d*d:(4-2*d)*d-1,r?e.scrollTop=s+l*n:e.scrollLeft=s+l*n,d<1&&requestAnimationFrame(t)}))},c=function(e,t){let i="slide"+document.querySelector("."+e.substring(1).replace("rec","slider")+"-container").querySelector(".tn-slider").id.replace("rec","")+"-"+(t+1);history.replaceState(null,"","#"+i)},f=function(){let e=window.location.hash;if(!e||!e.startsWith("#slide"))return null;let t=e.match(/^#slide\d+-(\d+)$/);return t?parseInt(t[1],10)-1:null},u=function(e){let t=document.querySelector("."+e.substring(1).replace("rec","slider")+"-container");if(!t)return;let i=t.querySelector(e),r=t.querySelector(".tn-slider-artboard"),s=t.querySelector(".tn-wrapper");s&&(r=s);let l=t.querySelectorAll(".tn-slide"),a=t.querySelectorAll(".tn-slide-elem"),o=t.querySelectorAll(".tn-slider-block"),n=t.querySelectorAll(".prev"),d=t.querySelectorAll(".next"),c=t.querySelectorAll(".tn-slider-spacing"),f=t.querySelectorAll(".tn-slider-styles");l.forEach((e=>{e.classList.remove("slides","active")})),a.forEach((e=>{e.classList.remove("tn-slide-elem","active")})),o.forEach((e=>{e.classList.remove("tn-slider-block","active","inactive"),e.style.display=""})),c.forEach((e=>{e.remove()})),f.forEach((e=>{e.remove()})),r.classList.remove("tn-slider-artboard"),r.querySelectorAll(".tn-elem").forEach((e=>{e.style.pointerEvents=""})),n.forEach((e=>e.classList.remove("tn-controls","active","inactive"))),d.forEach((e=>e.classList.remove("tn-controls","active","inactive"))),i.removeAttribute("style"),s||r.removeAttribute("style")};window.t_getCurrentScale=function(e){let t,i=1,r=0;if(void 0===e)void 0!==window.tn_scale_factor&&(i=window.tn_scale_factor);else{let s=document.querySelector(e);if(s){let e=s.querySelector(".t396__artboard"),l="window"===t396_ab__getFieldValue(e,"upscale"),a=s.getAttribute("id").replace("rec","");if(window.tn){if(window.tn["ab"+a]&&window.tn["ab"+a].scaleFactor){if(window.rescale&&window.rescale["ab"+a]&&!window.rescale.disabled)switch(window.rescale["ab"+a].direction){case"upscale":t=window.rescale["ab"+a].breakpoints[0];break;case"downscale":t=window.rescale["ab"+a].breakpoints[1];break;default:t=void 0!==window.rescale["ab"+a].breakpoints[1]?window.rescale["ab"+a].breakpoints[1]:window.rescale["ab"+a].breakpoints[0]}else t=window.tn["ab"+a].canvas_min_width,t>window.tn["ab"+a].curResolution_max&&(t=window.tn["ab"+a].curResolution_max);i=l?window.tn["ab"+a].scaleFactor:1,1===i&&(r=window.tn["ab"+a].grid_offset_left)}}else void 0!==window.tn_scale_factor&&(i=window.tn_scale_factor)}}return{breakpoint:t,factor:i,offset:r}},window.t_filterElems=function(e,t){void 0===t&&(t={}),void 0===t.nesting&&(t.nesting=1),void 0===t.exclude&&(t.exclude=!1);let i=[];return e.length&&e.forEach((function(e){let r=e;if(r.classList.contains("tn-atom")&&(r=r.closest(".tn-elem")),t.exclude&&"none"===window.getComputedStyle(r).display)return;let s=r.closest(".tn-group");for(let e=1;e<t.nesting&&s;e++)s=s.parentElement?.closest(".tn-group");if(s&&null!==s)-1===i.indexOf(r.closest(".tn-group"))&&i.push(r.closest(".tn-group"));else{let s=e.closest(".tn-molecule");if(s){let e=s.closest(".tn-group");for(let i=1;i<t.nesting&&e;i++)e=e.parentElement?.closest(".tn-group");e&&null!==e?-1===i.indexOf(s.closest(".tn-group"))&&i.push(s.closest(".tn-group")):-1===i.indexOf(r)&&i.push(r)}else-1===i.indexOf(r)&&i.push(r)}})),i},window.t_arrangeElems=function(e,t,i){if(Array.from(e).every((function(e){let t=e.closest(".tn-molecule");return t&&t.parentElement?.classList.contains("t396__group-flex")})))return e;if(void 0===i&&(i="top"),e.length>0){if(t&&t.length>0){let r=Array.from(t).map(((e,t)=>{let i;return i=e.classList.contains("tn-group")?"group":"field",{elem:e,left:t396_group__getFieldValue(e,"left")||parseFloat(e.getAttribute("data-"+i+"-left-value"))||0,top:t396_group__getFieldValue(e,"top")||parseFloat(e.getAttribute("data-"+i+"-top-value"))||0,index:t}}));r.sort((function(e,t){switch(i){case"top":return Math.abs(e.top-t.top)<=2?e.left-t.left:e.top-t.top;case"left":return Math.abs(e.left-t.left)<=2?e.top-t.top:e.left-t.left}}));let s=new Map;r.forEach(((e,t)=>{s.set(e.index,t)}));let l=Array.from(e).map(((e,t)=>({elem:e,baseIndex:s.get(t)})));return l.sort(((e,t)=>e.baseIndex-t.baseIndex)),l.map((e=>e.elem))}{let t=Array.from(e).map((function(e){let t;return t=e.classList.contains("tn-group")?"group":"field",{elem:e,left:t396_group__getFieldValue(e,"left")||parseFloat(e.getAttribute("data-"+t+"-left-value"))||0,top:t396_group__getFieldValue(e,"top")||parseFloat(e.getAttribute("data-"+t+"-top-value"))||0}}));return t.sort((function(e,t){switch(i){case"top":return Math.abs(e.top-t.top)<=2?e.left-t.left:e.top-t.top;case"left":return Math.abs(e.left-t.left)<=2?e.top-t.top:e.left-t.left}})),t.map((e=>e.elem))}}return[]},window.t_animateElems=function(e,t){if("function"==typeof t_animate__init){let i=e.querySelectorAll(".tn-elem.t-animate");if(i.length>0)switch(t){case"start":i.forEach((e=>{e.classList.contains("t-animate_wait")&&(e.classList.remove("t-animate_wait"),e.classList.add("t-animate_started"))}));break;case"reset":i.forEach((e=>{e.classList.contains("t-animate_started")&&(e.classList.remove("t-animate_started"),e.classList.add("t-animate_wait"))}));break;default:i.forEach((e=>{e.classList.contains("t-animate_wait")?(e.classList.remove("t-animate_wait"),e.classList.add("t-animate_started")):(e.classList.remove("t-animate_started"),e.classList.add("t-animate_wait"))}))}}if("function"==typeof t_animationSBS__init){let i=Array.from(e.querySelectorAll(".tn-elem[data-animate-sbs-opts]")).filter((e=>{let t=e.getAttribute("data-animate-sbs-event");return"hover"!==t&&"click"!==t}));if(i.length>0)switch(t){case"start":i.forEach((e=>{e.classList.contains("t-sbs-anim_started")||e.classList.add("t-sbs-anim_started")}));break;case"reset":i.forEach((e=>{e.classList.contains("t-sbs-anim_started")||e.classList.remove("t-sbs-anim_started")}));break;default:i.forEach((e=>{e.classList.contains("t-sbs-anim_started")?e.classList.remove("t-sbs-anim_started"):e.classList.add("t-sbs-anim_started")}))}}},window.t_checkVisibility=function(e){let t=e.getAttribute("data-screen-max"),i=e.getAttribute("data-screen-min"),r=!0;return null!==t&&window.innerWidth>parseInt(t)&&(r=!1),null!==i&&window.innerWidth<parseInt(i)&&(r=!1),r},window.t_checkUniformity=function(e){if(e.length<=1)return!0;let t=e[0];return e.every((e=>e===t))},window.t_catchEvent=function(e,t){let i=new Set,r=new Set;e.split(", ").map((function(e){return e.trim()})).forEach((function(e){r.add(e),window.addEventListener(e,(function(){i.add(e),i.size===r.size&&t()}))}))},window.t_dispatchEvent=function(e,t,i,r){void 0===r&&(r=10),void 0===t&&(t=""),i=void 0===i?"":"-"+i,setTimeout((function(){window.dispatchEvent(new Event(e+t+i))}),r)},window.t_sendError=function(e,t,i){window.mods||(window.mods={}),window.mods.errors||(window.mods.errors=[]),void 0===i&&(i="error");let r,s,l=e.indexOf("-");if(-1!==l?(r=e.substring(0,l),s=e.substring(l+1)):(r=e,s=void 0),!window.mods.errors.some((function(e){return e.message===t}))){let e={mod:r,type:i};void 0!==s&&(e.id=s),void 0!==t&&(e.message=t),window.mods.errors.push(e)}switch(i){case"error":i="Ошибка",console.error("["+r+".js] "+i+": "+t);break;case"warn":i="Предупреждение",console.warn("["+r+".js] "+i+": "+t)}},void 0===window.postnikovmd&&(window.postnikovmd="Maksim Postnikov, https://postnikovmd.com"),e.slider={init:t,scrollTo:s,destroy:u,version:"1.4",license:"MIT License: https://postnikovmd.com/mods/license",copyright:"© 2025 Maksim Postnikov"}}(window);
